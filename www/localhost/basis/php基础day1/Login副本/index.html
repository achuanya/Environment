<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>JQuery中Ajax的操作（实例二）- 模拟登陆</title>
</head>
<body>
<form name="loginForm" action="login.php" method="post">
  <p><input type="text" name="username" value="" placeholder="请输入账号"/></p>
  <p><input type="password" name="password" value="" placeholder="请输入密码"/></p>
  <p><input type="button" value="登录"/></p>
</form>

<script src="http://io/assets/js/jquery1.7.1.min.js"></script>
<script type="text/Javascript">
  //点击登录按钮触发点击事件
  $('input[type=button]').click(function () {
    loginSubmit(this);
  });

  function loginSubmit(_this) {
    //提交按钮
    var btn = $(_this);
    //验证账号
    var username = $('input[name=username]').val();
    if (username == null || username == '') {
      alert("用户名不能为空");
      return;
    }
    //验证密码
    var password = $('input[name=password]').val();
    if (password == null || password == '') {
      alert("密码名不能为空");
      return;
    }
    //form表单
    var form = $('form[name=loginForm]');
    //异步登录
    $.ajax({
      'url': 'login.php',
      'type': 'post',
      'data': form.serialize(),//序列化表单
      'dataType': 'json',
      'beforeSend': function () {
        //提交前禁用按钮
        btn.attr('disabled', 'disabled');
      },
      'success': function (result, status, xhr) {
        console.log(result);
        //什么都不输入点击登录 - 前端不判断空情况
        //Object {success: false, message: "账号和密码不能为空", data: null}
        //输入用户名或密码错误
        //Object {success: false, message: "用户名或密码错误", data: null}
        //用户名及密码正确
        //Object {success: true, message: null, data: "登录成功"}
        if (result.success) {
          //登录成功
          alert(result.data);
        } else {
          //登录失败
          alert(result.message);
        }
        //恢复按钮
        btn.removeAttr("disabled");
      },
      'error': function (xhr, status, error) {
        //登录异常
        console.log('status:' + status + ' error:' + error);
        //恢复按钮
        btn.removeAttr("disabled");
      }
    });
  }
</script>
</body>
</html>